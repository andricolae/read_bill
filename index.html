<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>OCR Bon de Cumpărături</title>
</head>
<body>
    <h1>Scanare Bon de Cumpărături</h1>

    <!-- Input pentru încărcarea unei imagini -->
    <input type="file" id="imageUpload" accept="image/*">
    <br><br>

    <!-- Afișarea textului extras -->
    <h3>Textul extras:</h3>
    <pre id="output"></pre>

    <!-- Scripturile necesare -->
    <!-- Include Tesseract.js -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js"></script>

    <!-- Scriptul principal -->
    <script>
        const imageUpload = document.getElementById('imageUpload');
        const output = document.getElementById('output');

        // Eveniment la încărcarea unei imagini
        imageUpload.addEventListener('change', event => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();

                reader.onload = function(e) {
                    // Creăm o imagine temporară din fișierul încărcat
                    const img = new Image();
                    img.src = e.target.result;

                    img.onload = function() {
                        // Cream un canvas temporar pentru capturarea imaginii
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        const context = canvas.getContext('2d');
                        context.drawImage(img, 0, 0, img.width, img.height);

                        // Convertim canvas-ul în blob și trimitem la Tesseract
                        canvas.toBlob(blob => {
                            Tesseract.recognize(
                                blob,
                                'ron', // Limba română; poți schimba în 'eng' pentru engleză
                                { logger: m => console.log(m) }
                            ).then(({ data: { text } }) => {
                                output.textContent = text;
                            })
                            .catch(err => {
                                console.error("Eroare la OCR:", err);
                            });
                        }, 'image/png');
                    };
                };

                reader.readAsDataURL(file);
            }
        });
    </script>
</body>
</html>
